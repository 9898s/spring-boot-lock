# 동시성 이슈
## MySQL을 활용한 다양한 방법
1. Pessimistic Lock
   - 실제로 데이터에 Lock을 걸어서 정합성을 맞추는 방법.
   - exclusive lock을 걸게 되면 다른 트랜잭션에서는 lock이 해제되기 전에 데이터를 가져갈 수 없게 된다.
   - 데드락이 걸릴 수 있기 때문에 주의를 요함.
2. Optimistic Lock
   - 실제로 Lock을 이용하지 않고 버전을 이용함으로써 정합성을 맞추는 방법.
   - 먼저 데이터를 읽은 후에 update를 수행할 때 현재 내가 읽은 버전이 맞는지 확인하여 업데이트한다.
   - 내가 읽은 버전에서 수정사항이 생겼을 경우에는 application에서 다시 읽은 후에 작업을 수행해야 한다.
3. Named Lock
   - 이름을 가진 metadata locking이다.
   - 이름을 가진 lock을 획득한 후 해제할 때까지 다른 세션은 lock을 획득할 수 없도록 한다.
   - 주의할 점으로는 transaction이 종료될 때 lock이 자동으로 해제되지 않는다.
   - 별도의 명령어로 해제를 수행해 주거나 선점 시간이 끝나야 해제된다.

---

## Redis를 활용한 다양한 방법
1. Lettuce
   - 구현이 간단하다.
   - spring data redis를 이용하면 lettuce가 기본이기 때문에 별도의 라이브러리를 사용하지 않아도 된다.
   - spin lock 방식이기 때문에 동시에 많은 스레드가 lock 획득 대기 상태라면 redis에 부하가 갈 수 있다.
2. Redisson
   - 락 획득 재시도를 기본으로 제공한다.
   - pub-sub 방식으로 구현이 되어있기 때문에 lettuce와 비교했을 때 redis에 부하가 덜 간다.
   - 별도의 라이브러리를 사용해야 한다.
   - lock을 라이브러리 차원에서 제공해 주기 때문에 사용법을 공부해야 한다.
     
---

### MySQL
- 이미 MySQL을 사용하고 있다면 별도의 비용 없이 사용 가능하다.
- 어느 정도의 트래픽까지는 문제없이 활용이 가능하다.
- Redis보다는 성능이 좋지 않다.

### Redis
- 활용 중인 Redis가 없다면 별도의 구축 비용과 인프라 관리 비용이 발생한다.
- MySQL보다 성능이 좋다.

---

[인프런 바로가기](https://inf.run/aB7k)
